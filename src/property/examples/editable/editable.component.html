<ng-template [ngTemplateOutlet]="properties" [ngTemplateOutletContext]="{ showBtn: true }"></ng-template>

<ng-template #templateDialog>
  <thy-dialog-header thyTitle="Dialog Title"></thy-dialog-header>
  <thy-dialog-body>
    <ng-template [ngTemplateOutlet]="properties" [ngTemplateOutletContext]="{ showBtn: false }"></ng-template>
  </thy-dialog-body>
</ng-template>

<ng-template #properties let-showBtn="showBtn">
  <thy-properties #properties thyEditTrigger="hover">
    <thy-property-item thyLabelText="姓名" thyEditable="true">
      {{ user.name }}
      <ng-template #editor>
        <input class="active" thyInput thySize="md" [(ngModel)]="user.name" />
      </ng-template>
    </thy-property-item>
    <thy-property-item thyLabelText="年龄" thyEditable="true">
      {{ user.age }}
      <ng-template #editor>
        <thy-input-number
          thySize="md"
          [(ngModel)]="user.age"
          [thyAutoFocus]="true"
          thyPrecision="0"
          [thyMax]="100"
          [thyStep]="1"
        ></thy-input-number>
      </ng-template>
    </thy-property-item>
    <thy-property-item thyLabelText="出生日期" thyEditable="true" #item>
      {{ user.birth_date * 1000 | date: 'yyyy-MM-dd HH:mm' }}
      <ng-template #editor>
        <thy-property-editable-date-inner [user]="user"></thy-property-editable-date-inner>
      </ng-template>
    </thy-property-item>
    <thy-property-item thyLabelText="电话" thyEditable="true">
      {{ user.phone }}
      <ng-template #editor>
        <input thyInput thySize="md" placeholder="" [(ngModel)]="user.phone" />
      </ng-template>
    </thy-property-item>
    <thy-property-item thyLabelText="性别" thyEditable="true" #hobby>
      <span>{{ user.sex || '无' }}</span>
      <ng-template #editor>
        <thy-custom-select thySize="md" [(ngModel)]="user.sex">
          <thy-option [thyValue]="'男'" [thyLabelText]="'男'"> </thy-option>
          <thy-option [thyValue]="'女'" [thyLabelText]="'女'"> </thy-option>
        </thy-custom-select>
      </ng-template>
    </thy-property-item>
    <thy-property-item thyLabelText="部门" thyEditable="true" #department>
      <span>{{ user.department?.name || '无' }}</span>
      <ng-template #editor>
        <thy-tree-select thySize="md" [thyTreeNodes]="departments" [(ngModel)]="user.department"> </thy-tree-select>
      </ng-template>
    </thy-property-item>
    <thy-property-item thyLabelText="爱好" thyEditable="true" #hobby>
      <span *ngIf="user.likes.length === 0">无</span>
      <thy-tag *ngFor="let item of user.likes" class="mr-1" thyShape="pill" thyColor="success">{{ item }}</thy-tag>
      <ng-template #editor>
        <thy-custom-select thyMode="multiple" thySize="md" [(ngModel)]="user.likes">
          <thy-option [thyValue]="'羽毛球'" [thyLabelText]="'羽毛球'"> </thy-option>
          <thy-option [thyValue]="'跑步'" [thyLabelText]="'跑步'"> </thy-option>
          <thy-option [thyValue]="'撸铁'" [thyLabelText]="'撸铁'"> </thy-option>
          <thy-option [thyValue]="'游泳'" [thyLabelText]="'游泳'"> </thy-option>
          <thy-option [thyValue]="'滑雪'" [thyLabelText]="'滑雪'"> </thy-option>
          <thy-option [thyValue]="'摩托车'" [thyLabelText]="'摩托车'"> </thy-option>
        </thy-custom-select>
      </ng-template>
    </thy-property-item>
    <thy-property-item thyLabelText="职业" thyEditable="true" #profession>
      <span *ngIf="!user.profession">无</span>
      <thy-tag thyShape="pill" thyColor="warning">{{ user.profession }}</thy-tag>
      <ng-template #editor>
        <thy-custom-select thySize="md" [(ngModel)]="user.profession">
          <thy-option [thyValue]="'教师'" [thyLabelText]="'教师'"> </thy-option>
          <thy-option [thyValue]="'运动员'" [thyLabelText]="'运动员'"> </thy-option>
          <thy-option [thyValue]="'科学家'" [thyLabelText]="'科学家'"> </thy-option>
          <thy-option [thyValue]="'程序员'" [thyLabelText]="'程序员'"> </thy-option>
          <ng-template #selectedDisplay let-value>
            <span class="text-truncate" *ngIf="value">
              <thy-tag thyShape="pill" thyColor="warning">{{ value }}</thy-tag>
            </span>
          </ng-template>
        </thy-custom-select>
      </ng-template>
    </thy-property-item>
    <thy-property-item thyLabelText="居住地址" thyEditable="true">
      {{ user.address }}
      <ng-template #editor>
        <input class="form-control" thyInput thySize="md" [(ngModel)]="user.address" rows="4" />
      </ng-template>
    </thy-property-item>
    <thy-property-item thyLabelText="打卡时间" thyEditable="true">
      {{ user.punch_time * 1000 | date: 'HH:mm' }}
      <ng-template #editor>
        <thy-time-picker [(ngModel)]="user.punch_time" thyFormat="HH:mm" thySize="md"></thy-time-picker>
      </ng-template>
    </thy-property-item>
    <thy-property-item thyLabelText="打开弹窗编辑" thyEditable="false" *ngIf="showBtn">
      <button thyButton="primary" thySize="md" (click)="openTemplateDialog(templateDialog)">
        Open Detail
      </button>
    </thy-property-item>
  </thy-properties>
</ng-template>
