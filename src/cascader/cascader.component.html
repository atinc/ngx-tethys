<div cdk-overlay-origin #origin="cdkOverlayOrigin" #trigger>
  <ng-container *ngIf="thyShowInput">
    <div
      thySelectControl
      [thySize]="thySize"
      [thyAllowClear]="true"
      [thySelectedOptions]="selected"
      (thyOnClear)="clearSelection($event)"
      [thyDisabled]="disabled"
      [thyIsMultiple]="thyMultiple"
      [thyPanelOpened]="menuVisible"
      [thyPlaceholder]="thyPlaceHolder"
      [customDisplayTemplate]="customDisplayTemplate"
    >
      <ng-template #customDisplayTemplate let-value>
        <span [ngClass]="labelCls">
          <ng-container *ngIf="!isLabelRenderTemplate; else labelTemplate">{{ value.labelText }}</ng-container>
          <ng-template #labelTemplate>
            <ng-template [ngTemplateOutlet]="thyLabelRender" [ngTemplateOutletContext]="value.labelRenderContext"></ng-template>
          </ng-template>
        </span>
      </ng-template>
    </div>
  </ng-container>
</div>

<ng-template
  cdkConnectedOverlay
  cdkConnectedOverlayHasBackdrop
  cdkConnectedOverlayBackdropClass="thy-cascader-backdrop"
  [cdkConnectedOverlayOrigin]="origin"
  [cdkConnectedOverlayPositions]="positions"
  [cdkConnectedOverlayWidth]="triggerRect?.width"
  (backdropClick)="closeMenu()"
  (detach)="closeMenu()"
  (attach)="onAttached()"
  (positionChange)="onPositionChange($event)"
  [cdkConnectedOverlayOpen]="menuVisible"
>
  <div #menu [ngClass]="menuCls" [ngStyle]="thyMenuStyle" (mouseleave)="onMenuMouseleave($event)">
    <ng-container *ngIf="thyColumns.length > 0; else emptyPlaceholder">
      <ul #cascaderOptionContainers *ngFor="let options of thyColumns; let i = index" [ngClass]="menuColumnCls">
        <li
          #cascaderOptions
          thy-cascader-option
          *ngFor="let option of options; trackBy: trackByFn"
          [option]="option"
          [multiple]="thyMultiple"
          (toggleSelectChange)="clickOption(option, i, $event)"
          (click)="clickOption(option, i, $event)"
          (mouseover)="onOptionMouseover(option, i, $event)"
          [labelProperty]="thyLabelProperty"
          [active]="isActivatedOption(option, i)"
        ></li>
      </ul>
    </ng-container>
    <ng-template #emptyPlaceholder>
      <thy-empty class="thy-select-empty-content " thySize="sm" [thyMessage]="emptyStateText"></thy-empty>
    </ng-template>
  </div>
</ng-template>
