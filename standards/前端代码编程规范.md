
## 一、通用规范

1. 结构、样式、行为分离，确保文档和模板只包含 HTML 结构，样式都放到样式表里，行为都放到脚本里

2. 文件的编码为不带 BOM 的   `UTF-8`  

3. 文件的换行为 LF，即 \n 表示换行

4. JS, SCSS, TypeScript 文件的缩进 (indent) 为 4 个空格，不要使用 Tab 或者 Tab、空格混搭，因为不同系统的编辑工具对 tab 解析不一样  （JSON, HTML 等其他文件使用2个空格的缩进）

5. 单行最大字符数为   `140`  ，超过自动换行

6. 对齐方式为：  `不对齐(Do not align)`  ，示例如下：

```
// Good
const link = {
     img: "btn.gif",
     text: "Button",
     width: 128
 };

// Bad
const link = {
     img  : "btn.gif",
     text : "Button",
     width: 128
 };	
```

7. 文件结构按照业务组件划分，划分目录和组织结构时要尽量可读易懂，每个业务组件包含 TypeScript(或者 Javascript)，HTML，SCSS，LESS 等资源，图片和字体资源分别存在在独立的目录下，示例如下：

```
-- app
 |-- work-item
 |   |-- work-item.component.html
 |   |-- work-item.component.scss
 |   |-- work-item.component.ts
 |-- project
 |   |-- detail
 |   |   |-- project-detail.component.ts
 |   |   |-- project-detail.component.html
 |   |   |-- project-detail.component.scss
 |   |-- index.component.html
 |   |-- index.component.scss
 |   |-- index.component.scss
```

8. 文件和文件夹命名保持和 Angular 风格一致，采用   `Kebab Case`   命名法（英文小写字母+数字或连接符-）用横杠来分隔单词，使用点来分隔描述性名字和类型（包括 *.service、*.component、*.pipe、.module、.directive，示例如下：

```
// Good
project.component.ts
work-item-detail.component.html
work-item-detai.service.ts

// Bad
workItem.html
WorkItem.html
work-item.html
work.item.detail.ts
```

### 

## 二、JavaScript 规范

### 2.1  命名规范

1.   `类 (Class) `  使用   `PascalCase`   命名法（每个单词首字母大写，如 TestPage)；如果类名称中包含单词缩写，则这个所写词的每个字母均应大写，如：XMLExample, 命名类时应尽量选择名词

*示例*  ：

```
// Good
class TaskService {
 constructor() {
 }
}
function XMLParser {
}

// Bad
class Taskservice {
 constructor() {
 }
}
class taskService {
 constructor() {
}
}
```



2.   `变量`  和  `方法`  采用  `驼峰（Camel Case）`  命名法(即名字的第一个单词应以小写字母或者特殊字符（_或者$）作为开头，后面的单词则用大写字母开头)

*示例：*

```
// Good 
const taskService = new TaskService()
const task = taskService.getTask();

// Bad
const TaskService = new TaskService()
const taskservice = new TaskService()
const task_service = new TaskService()
```

3.   `实体属性`  采用   `Snake Case`   命名法（即用下划线分割）, 与服务端保持统一（API 返回的数据和数据库表字段都是采用 Snake Case 命名法）

*示例：*

```
// Good
interface WorkItem {
  _id: number;
  project_name: string
}

// Bad
interface WorkItem {
  _id: number;
  projectName: string
}
```

4.   `常量 （constant）`  的名字推荐使用  `驼峰（camelCase）`  ​或   `全大写`  （不强制）

*示例：*

```
const maxValue = 9999999999;
const MAX_VALUE = 9999999999;
```

5.  ` I18n Key`   的名字应该都使用大写字母，并且指出该常量完整含义。如果一个常量名称由多个单词组成，则应该用下划线来分割这些单词

6. 接口命名规范 , 可读性强，见名晓义, 尽量不与 jQuery 或者 Angular.js 等社区已有的习惯冲突, 尽量写全, 不用缩写，除非是下面列表中约定的；（变量以表达清楚为目标，uglify 会完成压缩体积工作）

|**常用词**|**说明**|
|:---:|:---:|
|options|表示选项，不要用 config, opts 等|
|active|表示当前，不要用 current 等|
|index|表示索引，不要用 idx 等|
|trigger|触点元素，触发器|
|context|表示传入的 this 对象上下文|
|object|推荐写全，不推荐简写为 o, obj 等|
|element|推荐写全，不推荐简写为 el, elem 等|
|length|不要写成 len, l|
|prev|previous 的缩写|
|constructor|不能写成 ctor|
|min|minimize 的缩写|
|max|maximize 的缩写|
|btn|button 的缩写|
||


|result|避免写成rst等其他缩写|
|:---:|:---:|






### 2.2 编码规范

1. 禁止使用 var 定义变量，首先使用   `const`   ，不行再使用   `let`  ​

2. 操作运算符前后必须有空格，  `{}()`   号前后如果有字符也必须加空格

```
// Good
if (a === b && flag === true) {
 // do somethings
}

// Bad
if(a===b&&flag===true){
 // do somethings
}
```

3. 只有 If 的情况下 左大括号”{“居行尾，右大括号”}”单独占一行，居行首，如有 else，则与右大括号“}”同行

```
if (a && b) {
// do somethings
}
```

4. 句末必须用分号结尾

```
// Good
const task = {};

// Bad
const task = {}
```

5. if、while、for、do语句的执行体总是用   `”{“和”}” `  括起来，即使在其结构体内只有一条语句

```
if (s === 100) {
 return 'dota2';
}
```

6. 在 if 判断中，使用 === 作比较, 禁止使用 == 造成的陷阱；在条件判断时，这样的一些值表示false：null，undefined，字符串''，数字0，NaN, 而在 == 时，则会有一些让人难以理解的陷阱,如：

```
(function () {
 let undefined;
 undefined == null; // true 
 1 == true; //true 
 2 == true; // false 
 0 == false; // true 
 0 == ''; // true 
 NaN == NaN;// false 
 [] == false; // true 
 [] == ![]; // true 
})();
```

7. 字符串的拼接避免使用   `+`   或者   `+=`   , 尽量使用   `Array.join()`   或者   `ES6`   的模板字符串方法

```
// Good
const strArray = [];
for (let i = 0, len = list.length; i < len; i++) {
 strArray.push(`<div> ${list[i]} </div>`);
}
const str = strArray.join('');

// Bad
const str = '';
for (let i = 0, len = list.length; i < len; i++) {
 str += '<div>' + list[i] + '</div>';
}
dom.innerHTML = str;
```

8. 调试建议直接使用 Chrome 查看 Source 打断点，可以使用  `console.log()`  或者  `debugger`  进行，  `禁止使用弹出框`  ，提交 PR 需要  `去除所有调试代码`  



### 2.3 注释规范

**原则**  ：

- As short as possible（如无必要，勿增注释）- 尽量提高代码本身的清晰性、可读性
- As long as necessary（如有必要，尽量详尽）- 合理的注释、空行排版等，可以让代码更易阅读、更具美感
- 尽量通过合理的函数名表达函数的含义，实在需要注释，不建议写参数注释，因为参数的TS 类型已经足以表明含义的
- 操作注释, 单行注释,写在代码上面, //后面必须跟一个空格，如果只有一行不要多行注释，万不得已才使用多行注释


示例：

```
// 这是一个单行注释
var myBook = {};

/** 注释操作说明 */
for( var i = 0; i < tasks.lenght; i++) {
}
```



### 2.4  Angular 规范

#### **2.4.1 单一职责**

- 坚持每个文件只定义一样东西（例如服务或组件）
- 考虑把文件大小限制在 400 行代码以内
- 小函数，坚持定义简单函数，考虑在75行以内


#### 2.4.2 命名

1. 所有符号（组件，指令，服务，管道）使用一致的  ` Pascal Case`   命名规则 ，同时在结尾追加类型

2. 使用点和横杠来分隔文件名，使用   `feature.type.ts`   来描述符号的特性和类型

```
// File Name app.component.ts
@Component({ ... })
export class AppComponent { }

// File Name hero-list.component.ts
@Component({ ... })
export class HeroListComponent { }
```

3. 组件选择器使用   `dashed-case`   或者  ` kebab-case`   命名

```
// Good
@Component({
selector: 'agile-work-item-detail',
templateUrl: './work-item-detail.component..html'
})
export class WorkItemDetailComponent {}

// Bad
@Component({
selector: 'agileWorkItemDetail',
templateUrl: './work-item-detail.component.html'
})
export class WorkItemDetailComponent {}
```

4. 为组件添加自定义前缀，比如 agile 表示是敏捷开发的产品

```
/ Good
@Component({
selector: 'agile-project'
})
export class ProjectComponent {}

// Bad
@Component({
selector: 'project'
})
export class ProjectComponent {}
```

5. @Input()  @Output() 命名尽量不要与  `内置事件或者属性`  重名

```
// Good
@Input() headerTitle: string;
@Output() tabSelect = new EventEmitter(); 

// Bad (title和select是内置的属性和事件)
@Input() title: string
@Output() select = new EventEmitter(); 
```

6. @Output 命名不要以   `on`   开头 （因为Angular的模板语法中已经通过   `()`  ​来区分事件了）

```
// Good
@Output() tabSelect = new EventEmitter(); 

// Bad
@Output() onTabSelect = new EventEmitter(); 
```

7. 指令选择器采用   `Camel Case`   命名法

8. 管道名

```
// File Name ellipsis.pipe.ts
@Pipe({ name: 'ellipsis' })
export class EllipsisPipe implements PipeTransform { }
```

9. 单元测试文件名，测试文件名与被测试组件文件名相同，结尾添加  ` .spec`   后缀

![image.png](https://atlas-rc.worktile.com/files/public/5e889f9b3d3c46560becbf52/origin-url?token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1aWRfZm9yX3B1YmljX2ltYWdlIjoiMzFkNzEyMDA1MzA1NDQyMGIyOTE2NzdhZTU3NTQ5ZGEiLCJ0ZWFtX2Zvcl9wdWJsaWNfaW1hZ2UiOiI1ZGE0MjEzZTMyYjIwMjAwMzc3NTdkNzQiLCJibG9vbV9maWx0ZXIiOnsidHlwZSI6IkJsb29tRmlsdGVyIiwiX3NpemUiOjEwMjQsIl9uYkhhc2hlcyI6NSwiX2ZpbHRlciI6eyJzaXplIjoxMDI0LCJjb250ZW50IjoiZ0JBQUFBQUFBQkFBQUFBQUFDQUFBQUFBQUFBQkFBQUFBQUJBQUFBQUFBQUFBQUFBQUJBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBUUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBRUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBUUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBPSJ9LCJfc2VlZCI6NzgxODc0OTM1MjB9LCJpYXQiOjE3NjEzMDQzOTksImV4cCI6MTc2MTMxNTE5OX0.E5t9oG2hKteVvHJ4k80VNCIJXXQ913xX2yNZiYwTl9M)

10. Angular NgModule 命名: 符号名添加   `Module`   后缀, 用特性名和所在目录命名模块

![image.png](https://atlas-rc.worktile.com/files/public/5e889fbe6f02ca2fde801030/origin-url?token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1aWRfZm9yX3B1YmljX2ltYWdlIjoiMzFkNzEyMDA1MzA1NDQyMGIyOTE2NzdhZTU3NTQ5ZGEiLCJ0ZWFtX2Zvcl9wdWJsaWNfaW1hZ2UiOiI1ZGE0MjEzZTMyYjIwMjAwMzc3NTdkNzQiLCJibG9vbV9maWx0ZXIiOnsidHlwZSI6IkJsb29tRmlsdGVyIiwiX3NpemUiOjEwMjQsIl9uYkhhc2hlcyI6NSwiX2ZpbHRlciI6eyJzaXplIjoxMDI0LCJjb250ZW50IjoiZ0JBQUFBQUFBQkFBQUFBQUFDQUFBQUFBQUFBQkFBQUFBQUJBQUFBQUFBQUFBQUFBQUJBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBUUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBRUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBUUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBPSJ9LCJfc2VlZCI6NzgxODc0OTM1MjB9LCJpYXQiOjE3NjEzMDQzOTksImV4cCI6MTc2MTMxNTE5OX0.E5t9oG2hKteVvHJ4k80VNCIJXXQ913xX2yNZiYwTl9M)

11. Rxjs可订阅对象建议命名以   `$`  ​结尾

```
private ngUnsubscribe$ = new Subject();
```



#### 2.4.3 开发

1. 组件尽量减少层级，通过  `HostBinding`  来给组件添加根样式

```
// Good
@Component({
    selector: 'task-list',
    template: '<table>...</table>'
})
export class TaskListComponent {
  @Hostbinding('class.task-list') taskListClass = true;
  ...
}

// Bad
@Component({
    selector: 'task-list',
    template: `<div class='task-list'>
 				 <table>...</table>
			   </div>`
})
export class TaskListComponent {
  ...
}

```

2.  组件内的订阅需要记得取消（可以使用   `async`  ​ 让Angular来自动取消订阅，如果是自己订阅的，那么一定要在   `ngOnDestroy`   中取消）

3.  列表数据加载必须要定义   `loadingDone`  ​

4.  数据保存操作必须要定义   `​saving`  ​，避免重复点击

5.  组件模板中尽可能避免  `直接调用组件内的函数`  ​



#### 2.4.4 应用程序结构与 NgModule

**原则：**

- 快速定位 (Locate) 代码、一眼识别 (Identify) 代码、 尽量保持扁平结构 (Flattest) 和尝试 (Try) 遵循 DRY (Do Not Repeat Yourself, 不重复自己) 原则
- 尽可能保持扁平的目录结构，当同一目录下达到 7 个或更多个文件时创建子目录
- 尽可能保证每一块独立的业务对应一个模块 （TestCase -> test-case.module.ts ，TestPlan -> test-plan.ts），路由定义同理


#### 2.4.5 组件规范

   参考：  [Angular 官方风格指南](https://angular.cn/guide/styleguide#style-vocabulary)  



## 三、HTML 规范

### 3.1 文档类型声明<!DOCTYPE html>

编码统一为  ` <meta charset="UTF-8" />`  ,书写注意缩进,样式外链放在  `head`  中，脚本外链方在  `body`  底部。

```
<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>title</title>
    <link rel="stylesheet" href="..." />
</head>
<body>
   <!--some html-->
    <script src="..." />
</body>
</html>
```



### 3.2 所有标签和属性小写,注意标签的闭合，属性用双引号“”包裹。

`<br/>`  ​   `<hr/>`  ​     `<img/>`      `<input/>`     `<link/>`     `<meta/>`  ​ 等这些标签无需闭合，但最后的  `“ / ”`  不可省略



### 3.3 注意语意化、结构化标签[代码可读性]

 标题使用h系列，段落使用p，列表使用ul

```
<div class="modal-header">
    <a href="javascript:;" class="modal-close" ng-click="$close()"><i class="lcfont lc-close"></i></a>
    <h3 class="modal-title" translate="...">
       标题
    </h3>
</div>
<div class="modal-body">
   <div class="action-toolbar">
   </div>
    <ul>
        <li ng-repeat="">
        </li>
    </ul>
</div>
```



### 3.4 img标签必须有alt属性

```
<img ng-src="" alt=""/>
```



### 3.5 禁止使用的标签

`<font>`      `<center>`      `<acronym>`      `<applet>`     `<b>`      `<basefont>`  等html5不支持的标签

### 3.6 复杂的页面结构添加注释

### 3.7 建议国际化尽量使用属性转译，增加可阅读性

```
<span translate="drive.DESC">描述</span>
```



## 四、CSS，SCSS 规范

### 4.1 命名规范

CSS class 命名采用- 分割的  ` Snake Case`   命名（全小写，连接符 - 连接多个单词）

```
// Good
.task-list {
   background: @brand-primary;
}

// Bad 
.taskList {
   background: @brand-primary;
}
.TaskList {
   background: @brand-primary;
}
使用 -- 扩展 class

// Good
.task-list {
   &--project-detail {
      background: @brand-primary;
   }
}

// Bad 
.task-list {
   &.--project-detail {
      background: @brand-primary;
   }
   &.project-detail {
      background: @brand-primary;   
   }
}
```



### 4.2 编码规范

1.使用到的颜色，字体大小 全部使用组件库中的变量，禁止直接写死颜色值和字体大小

2. 禁止每个子应用写样式覆盖全局的组件样式，如是通用性的问题，修改组件，否则直接写应用级别样式覆盖

3. 属性排序建议(规则为：对布局的影响大小、修改频率、由内到外)

```
// Good
.task-list {

   /*显示、隐藏 -- 对布局影响最大*/
   display: flex;
   flex: 1;
   visibility: hidden;
   float: left;

   /*位置、间隔、宽高 -- 调整布局最常用*/
   position: absolute;
   top: 0;
   right: 0;
   bottom: 0;
   left: 0;
   margin: 0;
   padding: 0;
   width: 400px;
   max-width: 400px;
   height: 300px;

   /*文本 -- 由内到外，内容也会影响宽高布局*/
   font-size: 20px;
   line-height: 200%;
   color: #ff0000;
   text-decoration: none;
   text-shadow: 10px 10px 10px #ff0000;
   overflow: hidden;

   /*边线、背景 -- 对布局影响最小*/
   border: solid 1px #ff0000;
   border-radius: 100%;
   background: #ff0000;
   box-shadow: 10px 10px 10px #ff0000;
}
```

4. 避免使用 id 选择器， #header 不能重用，同时很难被 .header 复写

5. 避免使用 !important

6. 避免使用 margin-top ，使用 padding-top 或者 margin-bottom 填充，Vertical margins collapse 

8. Media Query 不得单独编排，必须与相关的规则一起定义

9. 可点击区域必须加小手   `cursor: pointer`  ​



## 五、 补充

#### 1.  代码格式插件统一使用 Prettier（使用 devkit 中的配置）

```
// .prettierrc.js
const { frontendConfig } = require('@worktile/devkit/prettier');
module.exports = frontendConfig;
```

#### 2.  必须安装代码拼写检查工具 Code Spell Checker

#### 3.  必须安装 TSLint ( 目前跟Angular统一，Angular升级成ESlint, 同步修改 )

### 

